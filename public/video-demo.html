<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Video.js Demo - Auto Switch</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸŽ¥</text></svg>">
  
  <!-- Video.js CSS -->
  <link href="https://vjs.zencdn.net/8.10.0/video-js.css" rel="stylesheet" />
  
  <style>
    body {
      margin: 0;
      padding: 0;
      background-color: #000;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      font-family: Arial, sans-serif;
    }
    
    .video-container {
      width: 100%;
      max-width: 1280px;
      position: relative;
    }
    
    .video-js {
      width: 100%;
      height: auto;
    }
    
    /* Fullscreen styling */
    .video-js.vjs-fullscreen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }
    
    .info-overlay {
      position: fixed;
      top: 20px;
      right: 20px;
      background: rgba(0, 0, 0, 0.7);
      color: white;
      padding: 15px;
      border-radius: 8px;
      font-size: 14px;
      z-index: 9999;
    }
    
    .unmute-hint {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(255, 193, 7, 0.95);
      color: #000;
      padding: 12px 20px;
      border-radius: 8px;
      font-size: 14px;
      font-weight: bold;
      z-index: 9999;
      cursor: pointer;
      transition: opacity 0.3s;
    }
    
    .unmute-hint:hover {
      background: rgba(255, 193, 7, 1);
    }
    
    .unmute-hint.hidden {
      display: none;
    }
    
    .info-overlay h3 {
      margin: 0 0 10px 0;
      font-size: 16px;
    }
    
    .info-overlay p {
      margin: 5px 0;
    }
  </style>
</head>
<body>
  
  <div class="info-overlay" id="infoOverlay">
    <h3>ðŸ“º Video Demo</h3>
    <p><strong>Status:</strong> <span id="status">Initializing...</span></p>
    <p><strong>Current Video:</strong> <span id="currentVideo">-</span></p>
    <p><strong>Time Elapsed:</strong> <span id="timeElapsed">0s</span></p>
    <p><strong>Next Switch:</strong> <span id="nextSwitch">45s</span></p>
    <p><strong>Fullscreen:</strong> <span id="fullscreenStatus">No</span></p>
  </div>
  
  <div class="unmute-hint" id="unmuteHint">
    ðŸ”‡ Click here to unmute audio
  </div>

  <div class="video-container">
    <video
      id="videoPlayer"
      class="video-js vjs-big-play-centered"
      controls
      preload="auto">
    </video>
  </div>

  <!-- Video.js JavaScript -->
  <script src="https://vjs.zencdn.net/8.10.0/video.min.js"></script>
  
  <script>
    // Video configuration
    const VIDEO_1 = '/videos/file_example_MP4_480_1_5MG.mp4';
    const VIDEO_2 = '/videos/3195394-uhd_3840_2160_25fps.mp4';
    const SWITCH_TIME = 45000; // 45 seconds in milliseconds
    
    let player;
    let currentVideoIndex = 1;
    let startTime = Date.now();
    let switchTimer = null;
    let isFullscreen = false;
    
    // Initialize Video.js player
    document.addEventListener('DOMContentLoaded', function() {
      player = videojs('videoPlayer', {
        fluid: true,
        aspectRatio: '16:9',
        autoplay: 'muted', // Muted autoplay is allowed by browsers
        muted: true, // Start muted
        controls: true,
        preload: 'auto',
        loop: false, // We'll handle looping manually for video 1
      });
      
      // Start with video 1
      loadVideo(VIDEO_1, 1);
      
      // Set up the switch timer
      scheduleVideoSwitch();
      
      // Update info display
      setInterval(updateInfo, 1000);
      
      // Handle unmute hint
      const unmuteHint = document.getElementById('unmuteHint');
      unmuteHint.addEventListener('click', function() {
        player.muted(false);
        player.volume(1);
        unmuteHint.classList.add('hidden');
      });
      
      // Auto-hide unmute hint if user unmutes via controls
      player.on('volumechange', function() {
        if (!player.muted()) {
          unmuteHint.classList.add('hidden');
        }
      });
      
      // Listen for fullscreen changes
      player.on('fullscreenchange', function() {
        isFullscreen = player.isFullscreen();
        updateFullscreenStatus();
      });
      
      // Handle video ended event
      player.on('ended', function() {
        if (currentVideoIndex === 1) {
          // Video 1 ended, loop it
          player.currentTime(0);
          player.play();
        } else {
          // Video 2 ended, could loop or switch back
          // For this demo, we'll just replay video 2
          player.currentTime(0);
          player.play();
        }
      });
      
      // Handle errors
      player.on('error', function(error) {
        console.error('Video error:', error);
        updateStatus('Error loading video');
      });
      
      updateStatus('Playing Video 1');
    });
    
    // Load a video source
    function loadVideo(src, videoIndex) {
      const wasFullscreen = player.isFullscreen();
      
      player.src({
        type: 'video/mp4',
        src: src
      });
      
      currentVideoIndex = videoIndex;
      
      // Load and play
      player.load();
      player.play().then(() => {
        updateStatus(`Playing Video ${videoIndex}`);
        updateCurrentVideo(`Video ${videoIndex}`);
        
        // Restore fullscreen state if it was fullscreen
        if (wasFullscreen && !player.isFullscreen()) {
          player.requestFullscreen();
        }
      }).catch(err => {
        console.error('Playback error:', err);
        updateStatus('Error playing video');
      });
    }
    
    // Schedule the video switch after SWITCH_TIME
    function scheduleVideoSwitch() {
      if (switchTimer) {
        clearTimeout(switchTimer);
      }
      
      switchTimer = setTimeout(() => {
        // Switch to video 2 after 45 seconds
        if (currentVideoIndex === 1) {
          console.log('Switching to Video 2...');
          loadVideo(VIDEO_2, 2);
        }
      }, SWITCH_TIME);
    }
    
    // Update info overlay
    function updateInfo() {
      const elapsed = Math.floor((Date.now() - startTime) / 1000);
      document.getElementById('timeElapsed').textContent = elapsed + 's';
      
      if (currentVideoIndex === 1) {
        const remaining = Math.max(0, 45 - elapsed);
        document.getElementById('nextSwitch').textContent = remaining + 's';
      } else {
        document.getElementById('nextSwitch').textContent = 'N/A';
      }
    }
    
    function updateStatus(status) {
      document.getElementById('status').textContent = status;
    }
    
    function updateCurrentVideo(video) {
      document.getElementById('currentVideo').textContent = video;
    }
    
    function updateFullscreenStatus() {
      document.getElementById('fullscreenStatus').textContent = isFullscreen ? 'Yes' : 'No';
    }
    
    // Cleanup on page unload
    window.addEventListener('beforeunload', function() {
      if (switchTimer) {
        clearTimeout(switchTimer);
      }
      if (player) {
        player.dispose();
      }
    });
  </script>
</body>
</html>

